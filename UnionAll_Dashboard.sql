-- UNION ALL: HKC + HKN in single table for Q00 With Code-Value separated - used in dashboard.
-- UNION ALL: HRC + HRN in single table for Q00 With Code-Value separated - used in dashboard.

CREATE OR REPLACE VIEW UnionAllTablesIDSCode AS
(SELECT 
CONCAT("HKC", JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID'))) AS SurveyFarmerID,
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID')) AS Q0000_FarmerID, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_SampleOrNot')) AS Q0000_SampleOrNot, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_Season')) AS Q0001_Season, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSCode')) AS Q0001_SeasonIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSValue')) AS Q0001_SeasonIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfSchedule')) AS Q0002_TypeOfSchedule, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSCode')) AS Q0002_TypeOfScheduleIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSValue')) AS Q0002_TypeOfScheduleIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000301_Team')) AS Q000301_Team, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000302_TeamCode')) AS Q000302_TeamCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000401_AgroclimaticZone')) AS Q000401_AgroclimaticZone, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000402_AgroclimaticZoneCode')) AS Q000402_AgroclimaticZoneCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000501_District')) AS Q000501_District, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000502_DistrictCode')) AS Q000502_DistrictCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001501_InvestigatorName')) AS Q001501_InvestigatorName, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001502_InvestigatorCode')) AS Q001502_InvestigatorCode, 
'HKC' AS TableName 
FROM HKC)
UNION ALL
(SELECT 
CONCAT("HKN", JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID'))) AS SurveyFarmerID,
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID')) AS Q0000_FarmerID, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_SampleOrNot')) AS Q0000_SampleOrNot, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_Season')) AS Q0001_Season, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSCode')) AS Q0001_SeasonIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSValue')) AS Q0001_SeasonIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfSchedule')) AS Q0002_TypeOfSchedule, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSCode')) AS Q0002_TypeOfScheduleIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSValue')) AS Q0002_TypeOfScheduleIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000301_Team')) AS Q000301_Team, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000302_TeamCode')) AS Q000302_TeamCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000401_AgroclimaticZone')) AS Q000401_AgroclimaticZone, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000402_AgroclimaticZoneCode')) AS Q000402_AgroclimaticZoneCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000501_District')) AS Q000501_District, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000502_DistrictCode')) AS Q000502_DistrictCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001501_InvestigatorName')) AS Q001501_InvestigatorName, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001502_InvestigatorCode')) AS Q001502_InvestigatorCode, 
'HKN' AS TableName 
FROM HKN)
UNION ALL
(SELECT 
CONCAT("HRC", JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID'))) AS SurveyFarmerID,
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID')) AS Q0000_FarmerID, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_SampleOrNot')) AS Q0000_SampleOrNot, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_Season')) AS Q0001_Season, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSCode')) AS Q0001_SeasonIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSValue')) AS Q0001_SeasonIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfSchedule')) AS Q0002_TypeOfSchedule, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSCode')) AS Q0002_TypeOfScheduleIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSValue')) AS Q0002_TypeOfScheduleIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000301_Team')) AS Q000301_Team, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000302_TeamCode')) AS Q000302_TeamCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000401_AgroclimaticZone')) AS Q000401_AgroclimaticZone, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000402_AgroclimaticZoneCode')) AS Q000402_AgroclimaticZoneCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000501_District')) AS Q000501_District, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000502_DistrictCode')) AS Q000502_DistrictCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001501_InvestigatorName')) AS Q001501_InvestigatorName, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001502_InvestigatorCode')) AS Q001502_InvestigatorCode, 
'HRC' AS TableName 
FROM HRC)
(SELECT 
CONCAT("HRN", JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID'))) AS SurveyFarmerID,
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_FarmerID')) AS Q0000_FarmerID, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0000_SampleOrNot')) AS Q0000_SampleOrNot, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_Season')) AS Q0001_Season, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSCode')) AS Q0001_SeasonIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0001_SeasonIDSValue')) AS Q0001_SeasonIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfSchedule')) AS Q0002_TypeOfSchedule, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSCode')) AS Q0002_TypeOfScheduleIDSCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q0002_TypeOfScheduleIDSValue')) AS Q0002_TypeOfScheduleIDSValue, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000301_Team')) AS Q000301_Team, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000302_TeamCode')) AS Q000302_TeamCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000401_AgroclimaticZone')) AS Q000401_AgroclimaticZone, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000402_AgroclimaticZoneCode')) AS Q000402_AgroclimaticZoneCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000501_District')) AS Q000501_District, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q000502_DistrictCode')) AS Q000502_DistrictCode, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001501_InvestigatorName')) AS Q001501_InvestigatorName, 
JSON_UNQUOTE(JSON_EXTRACT(JSON_Data, '$.Q00.Q001502_InvestigatorCode')) AS Q001502_InvestigatorCode, 
'HRN' AS TableName 
FROM HRN)